HW3
================

## Problem 2

Load and tidy demographic data.Exclude participants less than 21 years
of age, and those with missing demographic data; and encode data with
reasonable variable classes.

``` r
demo_df = 
  read_csv("data/nhanes_covar.csv", 
    skip = 4,
    na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  filter(age >= 21) |> 
  drop_na() |>
  mutate(
    sex = case_match(
      sex,
      1 ~ "male",
      2 ~ "female")) |>
  mutate(
    education = case_match(
      education,
      1 ~ "Less than high school",
      2 ~ "High school equivalent",
      3 ~ "More than high school"
    )) |>
  mutate(education = factor(education, levels = c("Less than high school", "High school equivalent", "More than high school"), ordered = TRUE))
```

    ## Rows: 250 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (5): SEQN, sex, age, BMI, education
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Load and tidy accelerometer data

``` r
accel_df = 
  read_csv("data/nhanes_accel.csv", 
    na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  pivot_longer(
    min1:min1440,
    names_to = "minute",
    values_to = "mims",
    names_prefix = "min"
  )
```

    ## Rows: 250 Columns: 1441
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (1441): SEQN, min1, min2, min3, min4, min5, min6, min7, min8, min9, min1...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Merge demographic and accelerometer data

``` r
merged_df = left_join(demo_df, accel_df)
```

    ## Joining with `by = join_by(seqn)`

Produce a table for the number of men and women in each education
category, and create a visualization of the age distributions for men
and women in each education category. Comment on these items.

``` r
merged_df |> 
  distinct(seqn, .keep_all = TRUE) |> 
  group_by(sex, education) |> 
  summarise(n_obs = n()) |>
  pivot_wider(
    names_from = "sex",
    values_from = "n_obs"
  )|> 
  knitr::kable()
```

    ## `summarise()` has grouped output by 'sex'. You can override using the `.groups`
    ## argument.

| education              | female | male |
|:-----------------------|-------:|-----:|
| Less than high school  |     28 |   27 |
| High school equivalent |     23 |   35 |
| More than high school  |     59 |   56 |

``` r
merged_df |> 
  distinct(seqn, .keep_all = TRUE) |> 
  ggplot(aes(x = age, fill = sex))+
  geom_histogram(binwidth = 5, alpha = 0.5) +
  facet_grid(. ~ education) +
  labs(
    title = 'Distribution of age by sex and education',
    y = 'Frequency',
    x = 'Age'
  )
```

![](p8105_hw3_jy3306_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->
